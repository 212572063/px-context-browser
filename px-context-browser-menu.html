<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="px-context-browser-menu-item.html"/>

<dom-module id="px-context-browser-menu">
  <link rel="import" type="css" href="css/px-context-browser.css" />
  <template>
    <div class="flex flex--col column push" data-column>
      <div class="head">{{menuData.header}}</div>
      <div class="flex__item scroll-y" on-scroll="scrollEndHandler">
        <ul class$="{{UlSelected(menuData, selectedItem)}}">
          <template is="dom-repeat" id="level" items="{{item.children}}">
            <px-context-browser-menu-item
              show-chevron
              item-data="[[item]]"></px-context-browser-menu-item>
          </template>
        </ul>
      </div>
    </div>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'px-context-browser-menu',
    properties: {
      /**
       * Item data passed from parent menu
       *
       * @type {Object}
       * @default null
       */
      menuData: {
        type: Object,
        value: null
      },
      /**
       * show chevron
       * @type {Boolean}
       * @default false
       *
       */
      showChevron: {
        type: Boolean,
        value: false,
        reflectToAttribute: true
      },
    },

    menu: null,

    ready: function() {
      this.parent = this.parentNode;

    },

    /**
     * Finds out if the passed UL has a child that's selected, and if so, add selected to the return path
     *
     * @param {Object} item
     * @param {selectedItem} the selected item.
     * @private
     */
    UlSelected: function(item, selectedItem) {
      var base = "list-bare level",
          id = this.idField,
          itemId = selectedItem[id];
      if (item.children) {
        for (var i = 0, len = item.children.length; i < len; i++) {
          if (item.children[i][id] === itemId) {
            base += " selected";
          }
        }
      }
      return base;
    }
  });
</script>
